# ml_dz

**1 ДЗ**

Студент: Попандопуло Костас Михайлович

О проделанной работе:

Был выполнен EDA анализ:

- Удалены дубликаты, восстановленны пропуски
- Сохранен отчет ydata (файл ydata-profiling)
- Пофиксил колонки, которые считались как str, привел к нужному типу
- Визуализировал pairplot, визуально проанализировал корреляции
- Построи корреляцию Пирсона, нашел что хорошо коррелирует (гипотезы из прошлого пункта +- верны)

Далее построили и обучили некоторые модели:

- Обычная линейная, получена R2 = 0.59
- Потом со скейлером, R2 = 0.59 (не изменилась, но узнал зависимости целевой переменной от признаков - самый важный признак - **max_power**, второй по важности - **year**)
- Построил Lasso регрессию, ничего не занулилось, возможно, все признаки важны, R2 = 0.59
- ElasticNet, R2 = 0.59

Добавил категориальные признаки:

- сделал OneHot encoding с помощью pd.get_dummies
- обучил Ridge модель - получил наконец улучшение - R2 = 0.63

Почитал бизнес метрику, поучил, что лучше всего себя показала Ridge

Сделал streamlit приложение, которое рисует EDA (примерно такое как в экпериментах выше) и считает модель по заданым признакам (или по CSV), а также выводит график весов
Приложение не особо удобное, т.к. нужно вводить признаки вручную.

Не удалось:
С помощью скалирования, Lasso, ElasticNet улучшить качество модели
Также, не удалось добавить в streamlit категориальные признаки, поэтому использую скейлер + линейная модель

Наибольший прирост дало добавление категориальных признаков в модель

В следующей итерации хотелось бы обучить нелинейную модель и посмтреть на метрики, или добавить кат. признаки 
(чтобы добавить их, необходимо сохранить признаки, над которыми работает обученная модель, заданные вручную признаки энкодить OneHead-ом и потом делать predict)